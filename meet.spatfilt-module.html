<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>meet.spatfilt</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="meet-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="meet-module.html">Package&nbsp;meet</a> ::
        Module&nbsp;spatfilt
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="meet.spatfilt-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module spatfilt</h1><p class="nomargin-top"><span class="codelink"><a href="meet.spatfilt-pysrc.html">source&nbsp;code</a></span></p>
<pre class="literalblock">

Spatial Filters

Submodule of the Modular EEg Toolkit - MEET for Python.

This module implements some spatial filters such as CSP, CCA, CCAvReg, bCSTP and QCA.

Author &amp; Contact
----------------
Written by Gunnar Waterstraat
email: gunnar[dot]waterstraat[at]charite.de

</pre>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="meet.spatfilt-module.html#CSP" class="summary-sig-name">CSP</a>(<span class="summary-sig-arg">data1</span>,
        <span class="summary-sig-arg">data2</span>,
        <span class="summary-sig-arg">center</span>=<span class="summary-sig-default">True</span>)</span><br />
      Common Spatial Pattern (CSP)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="meet.spatfilt-pysrc.html#CSP">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="meet.spatfilt-module.html#CCA_data" class="summary-sig-name">CCA_data</a>(<span class="summary-sig-arg">X</span>,
        <span class="summary-sig-arg">Y</span>)</span><br />
      Cannonical Correlation Analysis - by a combination of QR decomposition
and Singular Value Decomposition</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="meet.spatfilt-pysrc.html#CCA_data">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="meet.spatfilt-module.html#CCAvReg" class="summary-sig-name">CCAvReg</a>(<span class="summary-sig-arg">trials</span>)</span><br />
      Canonical Correlation Average Regression</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="meet.spatfilt-pysrc.html#CCAvReg">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="meet.spatfilt-module.html#bCSTP" class="summary-sig-name">bCSTP</a>(<span class="summary-sig-arg">trials1</span>,
        <span class="summary-sig-arg">trials2</span>,
        <span class="summary-sig-arg">num_iter</span>=<span class="summary-sig-default">30</span>,
        <span class="summary-sig-arg">s_keep</span>=<span class="summary-sig-default">2</span>,
        <span class="summary-sig-arg">t_keep</span>=<span class="summary-sig-default">2</span>,
        <span class="summary-sig-arg">verbose</span>=<span class="summary-sig-default">True</span>)</span><br />
      bilinear Common Spatial-Temporal Patterns</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="meet.spatfilt-pysrc.html#bCSTP">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'meet'"><code class="variable-quote">'</code><code class="variable-string">meet</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="CSP"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CSP</span>(<span class="sig-arg">data1</span>,
        <span class="sig-arg">data2</span>,
        <span class="sig-arg">center</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="meet.spatfilt-pysrc.html#CSP">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Common Spatial Pattern (CSP)

This takes the multivariate data in two conditions and finds the spatial filters which minimize
the variance in condition 2, while simultaneously maximizing the variance in condition one.

The algorithm uses Singular Value Decomposition since this is more stable than the Eigenvalue
Decomposition of the Covariance Matrices

The filters are scaled such, that Var(cond1) + Var(cond2) = 1. The eigenvalues give the variance
in condition 1.
The filters are in the columns of the filter matrix. Patterns can be obtained by inverting the filter matrix
and are located in the rows of the inverted filter matrix.

filter, eigval = CSP(data1, data2)
filtered_data = filter.T.dot(data1)

Input:
------
-- data1 - 2d array - data in condition 1 (variables in rows, observations in columns)
-- data2 - 2d array - data in condition 2 (variables in rows, observations in columns)
   The number of variables in data1 and data2 must be equal
-- center - bool - if data should be centered, defaults to True

Output:
-------
-- filter - where the individual filters are in the columns of the matrix (in order of decreasing eigenvalues)
-- eigvals - eigenvalues in decreasing order

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="CCA_data"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CCA_data</span>(<span class="sig-arg">X</span>,
        <span class="sig-arg">Y</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="meet.spatfilt-pysrc.html#CCA_data">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Cannonical Correlation Analysis - by a combination of QR decomposition
and Singular Value Decomposition

The filters are scaled to give unit variance in the components and are given in the order of decreasing
canonical correlations.

Patterns can be obtained by inverting the filter matrices.

Inputs:
-------
X - shaped p1 x N - variables in rows, obervations in columns
Y - shaped p2 x N - variables in rows, obervations in columns

Outputs:
--------
a - filters for X (shape p1 x d), where d is min(rank(X), rank(Y)), each filter is in one column 
b - filters for Y (shape p2 x d), where d is min(rank(X), rank(Y)), each filter is in one column 
s - canonical correlations in non-increasing order, each corresponding to the respective colum in a and b

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="CCAvReg"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CCAvReg</span>(<span class="sig-arg">trials</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="meet.spatfilt-pysrc.html#CCAvReg">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Canonical Correlation Average Regression

Calculate the CCA between trials and their average across trials

The filters are scaled to give unit variance in the components and are given in the order of decreasing
canonical correlations.

Patterns can be obtained by inverting the filter matrices.

notably, all single trials can be filtered at once by:
_np.tensordot(a, trials, axes=(0,0))

the filtered average can be obtained as:
_np.dot(b.T, trials.mean(-1))

Input:
------
-- trials - 3d numpy array - 1st dim: channels
                           - 2nd dim: epoch length
                           - 3rd dim: number of epochs

Output:
-------
-- a - 2d numpy array (channel x channel) - spatial filters for single trials, each filter is in one column
-- b - 2d numpy array (channel x channel) - spatial filters for average, each filter is in one column
-- s - the canonical correlations between single trials and averages

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="bCSTP"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">bCSTP</span>(<span class="sig-arg">trials1</span>,
        <span class="sig-arg">trials2</span>,
        <span class="sig-arg">num_iter</span>=<span class="sig-default">30</span>,
        <span class="sig-arg">s_keep</span>=<span class="sig-default">2</span>,
        <span class="sig-arg">t_keep</span>=<span class="sig-default">2</span>,
        <span class="sig-arg">verbose</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="meet.spatfilt-pysrc.html#bCSTP">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

bilinear Common Spatial-Temporal Patterns

In each iteration the number of kept patterns is reduced by one, in the last 5 iterations the finally desired
number of patterns is kept.
The minimal number of iterations must therefor be &gt; 10

Filter matrices won't be square if the data was rank deficient, patterns can then be obtained by using the pseudo-inverse
(numpy.linalg.pinv)

Input:
------
-- trials1 - 3d numpy array - 1st dim: channels
                            - 2nd dim: epoch length
                            - 3rd dim: number of epochs
   variance in condition 1 is maximized
-- trials2 - 3d numpy array - 1st dim: channels
                            - 2nd dim: epoch length
                            - 3rd dim: number of epochs
   variance in condition 2 is minimized
-- num_iter - int - number of iterations to do, defaults to 30 (minimum 10)
-- s_keep - int - number of spatial patterns to keep, defaults to 2
-- t_keep - int - number of temporal patterns to keep, defaults to 2
-- verbose - bool - if number of iterations should be printed during execution

Output:
-------
-- W - list of 2d arrays - spatial filter matrix for each iteration, the final spatial filters are in W[-1]
-- V - list of 2d arrays - temporal filter matrix for each iteration, the final temporal filters are in V[-1]
-- s_eigvals - list of 1d array - spatial eigenvalues, the final spatial eigenvalues are in s_eigvals[-1]
-- t_eigvals - list of 1d array - temporal eigenvalues, the final temporal eigenvalues are in s_eigvals[-1]

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="meet-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat Mar 29 13:36:39 2014
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
